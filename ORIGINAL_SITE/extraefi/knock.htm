<html>
<head>
<title>ExtraEFI.co.uk Downloads</title>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-29880327-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<style type="text/css">
.style28 {color: #EEEEEE}
</style>
<script src="SpryAssets/SpryMenuBar.js" type="text/javascript"></script>
<link href="SpryAssets/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css">
<link href="SpryAssets/SpryMenuBarVertical.css" rel="stylesheet" type="text/css">
<link href="SpryAssets/SpryMenuBarHorizontal.css" rel="stylesheet" type="text/css">
<link href="SpryAssets/SpryMenuBarVertical.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="Main.css" />
<style type="text/css">
<!--
.style27 {color: #000000}
.style20 {	color: #000000;
	font-size: large;
	font-weight: bold;
}
.style21 {	font-size: large;
	font-weight: bold;
}
.style22 {	color: #FFFF00;
	font-weight: bold;
}
.style29 {color: #000000; font-size: large; font-weight: bold; font-style: italic; }
-->
</style>
</head>

<!--COPY FROM HERE-->
<body bgcolor="#fff" text="#000" background="Pix/backing.jpg" link="#000" vlink="#333" alink="#ccc">

<div id="page-wrapper">
    
    <table width="100%" bgcolor="#000">
        <tr>
            <td><class="style10"><a href="http://extraefi.co.uk"><img src="../../WebstormProjects/extraefiNEW/img/new_title2.jpg" width="100%" alt="ExtraEFI" /></a></td>
        </tr>
  </table>
  
    <table bgcolor="#fff" id="MenuBarHorizontal">
        <tr>
            <td bgcolor="#eee"><ul type="circle" class="MenuBarHorizontal style28" id="MenuBar1">
                <li name="lbNavDisplay">
                    <div align="center"><a class="MenuBarItemSubmenu" href="#">Products</a>
              <ul>
                <li>
                  <div align="center"><a href="MS_All_products.htm" class="MenuBarItemSubmenu">Engine Management</a>
                      <ul>
                        <li>
                          <div align="center"><a href="MS_All_products.htm">MegaSquirt ECU's</a></div>
                        </li>
                        <li>
                          <div align="center"><a href="RV8_Kits.html#pnp">RV8 Plug-n-Play</a></div>
                        </li>
                        <li><a href="RV8_Kits.html">V8 Bundles</a></li>
                      </ul>
                  </div>
                </li>
                <li>
                  <div align="center"><a href="Misc_products.htm" class="MenuBarItemSubmenu">Accessories</a>
                      <ul>
                        <li>
                          <div align="center"><a href="Misc_products.htm">Knock Conditioners, Temp Sensors, Relays, Connectors, Trigger Wheels, Looms and much more</a></div>
                        </li>
                      </ul>
                  </div>
                </li>
                <li>
                  <div align="center"><a href="#" class="MenuBarItemSubmenu">ECU Bundles</a>
                      <ul>
                        <li>
                          <div align="center"><a href="RV8_Kits.html">8 Cylinder Engines</a></div>
                        </li>
                        <li>
                          <div align="center"><a href="RV8_Kits.html#pnp">RV8 Plug-n-Play</a></div>
                        </li>
                      </ul>
                  </div>
                </li>
                <li>
                  <div align="center"><a href="RV8_Kits.html#pnp">Rover V8 ECU's</a></div>
                </li>
                <li><a href="MX5.html">Mazda MX5 ECU's</a></li>
              </ul>
          </div>
        </li>
        <li>
          <div align="center"><a href="#" class="MenuBarItemSubmenu">Support</a>
              <ul>
                <li>
                  <div align="center"><a href="support.htm">Help &amp; Support Files</a></div>
                </li>
                <li>
                  <div align="center"><a href="drawings.htm">Drawings &amp; Diagrams</a></div>
                </li>
                <li>
                  <div align="center"><a href="downloads.htm">Download Area</a></div>
                </li>
                <li>
                  <div align="center"><a href="video.html">Video Help</a></div>
                </li>
              </ul>
          </div>
        </li>
        <li>
          <div align="center"><a href="#" class="MenuBarItemSubmenu">FAQ's</a>
              <ul>
                <li>
                  <div align="center"><a href="faq.htm">FAQ's</a></div>
                </li>
                <li>
                  <div align="center"><a href="glossary.htm">Glossary of MegaSquirt Terms</a></div>
                </li>
                <li><a href="Untitled Item">Compare ECU's</a></li>
                <li><a href="information_OL.htm">Still Confused?</a></li>
                <li>
                  <div align="center"><a href="terms.htm#Warranty">ExtraEFI Warranty</a></div>
                </li>
                <li>
                  <div align="center"><a href="terms.htm">Terms of Use for ExtraEFI website</a></div>
                </li>
                <li>
                  <div align="center"><a href="history.htm">ExtraEFI Company Profile</a></div>
                </li>
              </ul>
          </div>
        </li>
        <li>
          <div align="center"><a href="#" class="MenuBarItemSubmenu">Services</a>
              <ul>
                <li> <a href="services.htm">Fitting &amp; Tuning</a></li>
                <li>
                  <div align="center"><a href="services.htm">MegaSquirt Upgrades</a></div>
                </li>
              </ul>
          </div>
        </li>
        <li>
          <div align="center"><a href="#" class="MenuBarItemSubmenu">New Stuff</a>
            <ul>
              <li><a href="MX5.html">MX5 PnP ECU's</a></li>
              <li><a href="Misc_products.htm">Knock Conditioners</a></li>
              <li><a href="Misc_products.htm#usbadap">Built-in USB Port</a></li>
            </ul>
            </div>
        </li>
        <li>
          <div align="center"><a href="gallery.htm">Gallery</a> </div>
        </li>
        <li>
          <div align="center"><a href="feedback.html">Feedback</a></div>
        </li>
        <li>
          <div align="center"><a href="cobra/index.htm">Cobra Replica</a></div>
        </li>
        <li>
          <div align="center"><a href="gallery.htm#links">Links</a></div>
        </li>
      </ul></td>
    </tr>
  </table>

<div id="email-border">
  <p style="font-size: 24px;">Click <a href="mailto:phil@extraefi.co.uk">here</a> to email me if you have any questions</p>
</div>
<!--STOP COPYING HERE-->

<h1>
  Knock Conditioner Unit
</h1>

    <table width="100%" bgcolor="#FFFFFF">
      <!-- InstanceBeginEditable name="EditRegion3" -->
      <tr>
        <td width="100%" height="939" bgcolor="#666666"><div align="center">
      <div align="center">
      <blockquote>
      <p align="center" class="style27"><b>Jump To:</b><br><br><a href="#knock_unit">ExtraEFI Knock Conditioner Unit</a> -- <a href="#ms1">MS1 Settings</a> -- <a href="#ms2">MS2 Settings</a> -- <a href="Misc_products.htm#knock">Purchase a Knock Unit</a></p>
    </p>
    <p align="left"><font color="#000000">Knock (or detonation) is the sound of 
      uncontrolled burning of the air/fuel mix causing the pressure to suddenly 
      increase within the cylinder. Many factors can cause this, air temperature, 
      coolant temperature, air/fuel mix, air density, etc.</font></p>
    <p align="left"><font color="#000000">A knock sensor can be used to detect 
      this sound, but it can be very hard to setup or tune as most manufactorures 
      will have spent a lot of time and effort tuning their sensor for a specific 
      frequency. For example the sensor on the Corvette (GM PN 1997562, 1997699) 
      is designed to pick up around 5.2Khz and operates around 4800 - 5600 RPM. 
      So just by bolting a sensor to your engine block you are not necassarily 
      going to detect any harmful knocks. </font></p>
    <p align="center"><img src="Pix/knocksnr.GIF" width="137" height="219"></p>
    <p align="left"><font color="#000000">The best option as far as tuning goes, 
      is to use a pair of air defenders without any wadding in them. Simply get 
      a piece of copper pipe (brake pipe) and flatten one end of it enough to 
      bolt it to the cylinder head. Then attach a piece of plastic tube (fish 
      tank air pipe) on the other end of the copper pipe. Drill a small hole in 
      one of the ear pieces and push the other end of the pipe into it. Now any 
      knock you will be able to hear clearly whilst tuning. </font></p>
    <p align="left"><span class="style29">Please note that the MS2 PnP ECUs for MX5's already have this conditioner built in. So simply connect the 2 wires, in the mini loom I provide, to the knock sensor and away you go.<br>
Adjustment for sensitivity is inside the ECU.</span></p>
    <p align="left" class="style20"><a name="knock_unit"></a>ExtraEFI Knock Conditioner:</p>
    <p align="left"><span class="style27"><strong>2 Knock Sensor Inputs</strong> with <strong>Isolated</strong> <strong>Band Pass Filters</strong><em> - designed to work within the frequency range of most OEM sensors. </em><br>
          <strong>Adjustable Sensitivity</strong> - <em>The conditioner can be adjusted to ensure it triggers at the desired voltage level. </em></span><br>
          <span class="style27"><strong>LED indication</strong></span> <span class="style27"><em>- The case has a built in LED to show when knock has been detected</em></span>.<br>
          <span class="style27"><strong>MS ECU compatable output</strong><em> - The output is regulated to 5V making it compatable to directly wire to an MS ECU. This can also be used to trigger an external LED (dash board mounted) if needed.</em></span></p>
    <p align="left"><font color="#000000">Please remember that this is not a magic 
      pill, if you have detonation then you have issues you need to address and 
      cure!</font></p>
    <p align="left" class="style22">Click <a href="Misc_products.htm#knock">here</a> to purchase a knock conditioner unit.</p>
    <p align="left" class="style29">&nbsp;</p>
    <p align="left" class="style21"><font color="#000000">1) LED on Dashboard Wiring:</font></p>
    <p align="center"><img src="Pix/knock_circuit_LED.JPG" width="605" height="433"></p>
    <p align="left"><span class="style21"><font color="#000000">2) MS ECU Wiring:</font></span></p>
    <p align="left"><font color="#000000">The ECU's I supply are ready to work with the conditioner unit we sell, if you requested a knock input, although they may not have the programmable output. This is an option if you wish to add it.</font></p>
    <p align="center"><img src="Pix/knock_circuit.JPG" width="631" height="433"></p>
    <p align="left" class="style20">&nbsp;</p>
    <p align="left"><b><span class="style21"><font color="#000000"><a name="ms1"></a>MS1 Settings:</font></span></b></p>
    <p align="left"><img src="Pix/knock_Insert_ms1.JPG" width="835" height="373"></p>
    <p align="left">
      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
    <!--  		@page { margin: 2cm }  		P { margin-bottom: 0.21cm }  	-->
    </p>
    <p align="left"> <font color="#000000">As long as the engine speed is below the  Ignore Knock RPM setpoint and the MAP <em>Kpa</em> is below the Ignore  Knock setpoint then the code will control the advance in the  following manor:</font></p>
    <p align="left"> <font color="#000000">If a knock is detected (The input goes  switches to ground) the ignition will be retarded by the &ldquo;<em>First  Knock</em>&rdquo; retard value. Any more knocks are then stored until the  timer &ldquo;<em>Wait time between steps</em>&rdquo; has passed. If any more  knocks where seen then the ignition is retarded by the &ldquo;<em>Subsequent  Knock</em>&rdquo; value. This allows a big first step then smaller steps  after that if knock continues.</font></p>
    <p align="left"> <font color="#000000">If no knocks are then seen after the wait  period it will advance the ignition by the &ldquo;<em>Advance when no  knock&ldquo;</em> value (this should be smaller than the retard value).  After the wait period is over, as long as no knocks are seen, it will  advance again until it runs the same advance as the main ignition  map.</font></p>
    <p align="left"> <font color="#000000">If a knock is seen whilst its advancing then  the timer is reset and the ignition is retarded immediately and the  whole process starts over. </font></p>
    <p align="left"> <font color="#000000">There is also a limit to how much retard can  be applied. </font></p>
    <p align="left"> <font color="#000000">The boost can also be linked into this  system if using boost control.</font></p>
    <p align="left"><b><span class="style21"><font color="#000000"><a name="ms2"></a>MS2 Settings:</font></span></b><font color="#000000"><em><br>
    </em></font></p>
    <p align="left">
      <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
      <HTML>
      <!--  		@page { margin: 2cm }  		P { margin-bottom: 0.21cm }  	-->
      <BODY DIR="LTR">
      <img src="Pix/knock_MS2.JPG" width="1038" height="699"></p>
    <blockquote>
      <p align="left"><em><strong><span class="style21"><font color="#000000">Knock Control:</font></span></strong></em><font color="#000000"><br><br>
            <em><strong>Disabled</strong></em>: do not use knock  feedback for ignition advance control. </font></p>
    </blockquote>
    <UL>
      <LI>
      <p ALIGN="left"><font color="#000000"><em><strong>Safe Mode</strong></em>:<br> use knock retard, but  	keep the advance below that which caused knock. This backs the  	advance 1 small step back and leaves it at that until TPS or MAP  	changes - or knock comes back. This is &quot;safe mode&quot; scheme  	is the safest thing for a DIY set-up. </font></p>      
      <LI>
      <div align="center"><em><strong>Input Type</strong></em></div>
      <LI>
      <div align="center">On / Off is for use with conditioner units where the signal for knock is a ground or 5V signal in.<br>
        <br>
      Analouge is when a special filtering circuit is used and this is directly fed back to the ECU, so the level of input before knock is detected, can vary depending on RPM.</div>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Aggressive Mode</strong>: <br>use knock retard, but keep  	advance at threshold of knock occurring. That is, the program  	advances (up to the timing table value) if it doesn't see knock, and  	retards if does see knock. The difference from safe mode is that the  	timing can be advance all the way to the table value after knock,  	not just up to one step below knock. This may result in the knock  	returning, in which case the timing is retarded again, then advanced  	slowly, and so on.</font> </p>
      <LI>
        <p align="left"><strong><font color="#000000">Knock Input Pin:</font></strong><br>This is set depending on what pin is used on the main board. For ExtraEFI boards I use JS4, but check on the bottom of the ECU for details.</font>
        <UL>
          </UL>
  <LI>
        <p ALIGN="left"><font color="#000000"><strong>Knock Indicated by</strong>: <br>This sets whether MegaSquirt recognizes a knock with a low signal or a high, for most conditioners this should be set to<strong> low</strong> (Input goes to ground for a knock). </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Pull Up/Down on Input</strong>: <br>
        The input pin can be held high (5V), Low (0V) or left floating (None) using the microprocessors internal circuit. This setting is dependant on how your conditioner works, measure the output voltage of the conditioner when it is powered up but not connected to the MS ECU. If it measures nearly 0V then select <strong>Held High</strong>, if it measures 5V then select <strong>None</strong>, if it measures 12V then <strong>DO NOT</strong> connect it directly to the MS ECU, see the above circuits!!</font> The knock conditioner units need this set to &quot;Pull up&quot;</p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Knock Count</strong><br> (knocks): number knock detects  	required for valid detection. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>No Knock Above MAP</strong><br> (kPa): no knock retard  	is implemented above this MAP. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>No Knock Below RPM</strong><br> (rpm): no knock retard  	is implemented below this rpm. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>No Knock Above RPM</strong><br> (rpm): no knock retard  	is implemented above this rpm, which may be desirable if valve train  	noise triggers the knock sensor when knock isn't actually occurring. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Maximum Retard</strong><br> (deg): maximum total retard  	when knock occurs. This can be useful to prevent timing from being  	excessively retarded (avoiding potential overheating issues) if the  	senor malfunctions or there are other problems with the knock  	sensing system. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Retard Check Time</strong><br> (sec): this is the time  	between knock retard corrections, allows short time step to quickly  	retard. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Retard Step Size</strong><br> (deg): ignition retard  	step size when 1st knock or after stopped, make it large to quickly  	retard the timing and stop knock. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Advance Check Time</strong><br> (sec): this is the time  	between knock advance correction (I.e., timing return to 'normal'). </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Advance Step Size</strong><br> (deg): ignition advance  	steps after knock has stopped. </font></p>
      <LI>
        <p ALIGN="left"><font color="#000000"><strong>Recovery Advance</strong><br> (deg): this is the change  	in table advance required to restart advance until knock or reach  	table value (0 knock retard) process. This only applies in 'Safe  	Mode'.<BR>
        </font> </p>
      <div align="center">
      <p><a href="software/knock.pdf">PDF file of this page</a></p>
    </div>
    <br>
    <!--Footer-->
    <div id="footer">
    <table width="100%">
      <tr>
        <td height="97" background="Pix/new_title1.jpg"><div align="center"><span style="color: #fff;">Content &copy; 
        <a href="http://www.extraefi.co.uk" style="color: #fff;">ExtraEFI</a>. All Rights Reserved.</span><br>
                  <a href="terms.htm" style="color: #fff;">Terms of Use.</a><br>
                  <span style="color: #fff;">Layout of this website was worked on by</span> <a href="http:chrisbrighton.co.uk" target="_blank" style="color: #fff;">
                  Chris Brighton.</a></span></div></td>
      </tr>
    </table>
    </div>

<script type="text/javascript">
<!--
var MenuBar1 = new Spry.Widget.MenuBar("MenuBar1", {imgRight:"SpryAssets/SpryMenuBarRightHover.gif"});
//-->
</script>
</body>
</html>
